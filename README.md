# Avee-like Media Player (PHP/XAMPP)

A fully-featured, browser-based media player built with PHP and the Web Audio API, designed to run on XAMPP. It delivers feature parity with Avee Player Pro's core capabilities and adds enhancements like exportable visualizer recordings, crossfade, and secure uploads.

## Features

- Audio playback with:
  - Crossfade between tracks
  - Shuffle and repeat
  - Volume and playback speed control
- Customizable visualizers:
  - Styles: bars, waveform, circular spectrum
  - Color gradients
  - Real-time rendering via Web Audio API
  - Record visualizer (WebM) with audio using MediaRecorder
- Playlist management:
  - Create, delete, rename (via API)
  - Add/remove tracks
  - Play from playlists
- Equalizer:
  - 10-band peaking EQ (31 Hz â€“ 16 kHz)
  - Presets: Flat, Pop, Rock, Jazz, Bass Boost, Treble Boost
- PHP integration:
  - Library scanning from `assets/music/`
  - Secure upload endpoint with CSRF protection
  - File-based storage for library index and playlists (JSON)
- Security:
  - CSRF protection on all POST endpoints
  - Upload directory disables PHP execution via `.htaccess`
  - Input sanitization and extension whitelisting
- Performance and scalability:
  - Cached library index (`data/music_index.json`)
  - Pagination-ready endpoints
  - Efficient Web Audio pipeline and lazy UI rendering

## Directory Structure

```
index.html
assets/
  style.css
  script.js
  js/
    utils.js
    equalizer.js
    visualizer.js
    playlists.js
    app.js
  music/
    .htaccess
api/
  config.php
  session.php
  library.php
  playlists.php
  upload.php
data/
  music_index.json
  playlists.json
```

## Setup (XAMPP)

1. Copy this project into your XAMPP `htdocs` directory, e.g.:
   - Windows: `C:\xampp\htdocs\avee-player`
   - macOS: `/Applications/XAMPP/htdocs/avee-player`
   - Linux: `/opt/lampp/htdocs/avee-player`
2. Ensure Apache/PHP are running.
3. Visit `http://localhost/avee-player/` in your browser.
4. Add audio files by:
   - Dropping them into `assets/music/`
   - Or using the Upload button (accepted: mp3, wav, ogg/opus, m4a/aac, webm, flac*)

\* Note: Browser support for formats varies. MP3, AAC/M4A, OGG/Opus, WAV, and WebM are widely supported. FLAC may not play natively but is stored and indexed.

## Usage

- Library sidebar:
  - Search, rescan, upload
  - Click a track to play
- Player core:
  - Visualizer renders real-time spectrum/waveform
  - Controls for play/pause, next/prev, shuffle/repeat, volume, speed
  - Record to WebM (Canvas + Audio) via MediaRecorder (Chrome/Edge)
- Equalizer:
  - Toggle the EQ panel
  - Use presets or adjust individual bands
- Playlists:
  - Create/select a playlist
  - Add the current track using "Add Current Track"
  - Remove tracks from the playlist

## Security Notes

- Uploads are restricted to a safe extension whitelist.
- CSRF tokens are required for all state-changing API calls.
- PHP engine is disabled in `assets/music/` via `.htaccess`.

## Enhancements Roadmap

- Optional FFmpeg integration (server-side transcoding to MP3 for unsupported formats)
- Cloud sync (Dropbox/Google Drive) using API integrations
- Smart playlists (rules-based generation)
- Gapless playback with pre-buffering improvements
- Advanced time-stretching (tempo without pitch shift) via SoundTouch.js

## Troubleshooting

- If uploads fail, check `php.ini`:
  - `upload_max_filesize`
  - `post_max_size`
- If audio doesn't play:
  - Ensure format is supported by your browser
  - Try MP3 or OGG/Opus for best compatibility
- If recording fails:
  - Use a Chromium-based browser
  - Ensure autoplay policies allow audio playback after user gesture

Generated by Genie
